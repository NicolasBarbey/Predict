{javascripts file='assets/js/bootstrap-switch/bootstrap-switch.js'}
<script src='{$asset_url}'></script>
{/javascripts}


<script>
    $(document).ready(function() {
        /* forms management (create, update, delete) */
        // create
        $(".create_price_slice_button").click(function() {
            var area_value = $(this).data("area");
            $("#create_price_slice_form_area").val(area_value);
        });

        /* free shipping switch management */
        var freeshipping_switch = $(".freeshipping-activation-Predict");
        freeshipping_switch.bootstrapSwitch();

        freeshipping_switch.on("switch-change", function(e, data){
            var is_checked = data.value;
            var form = $("#freeshippingform");
            $('body').append('<div class="modal-backdrop fade in" id="loading-event"><div class="loading"></div></div>');
            $.ajax({
                url: form.attr('action'),
                type: form.attr('method'),
                data: form.serialize()
            }).done(function(){
                $("#loading-event").remove();
            }).success(function() {
                if (is_checked) {
                    $('#config-btn-0').removeClass('disabled');
                    $('#table-prices-predict').hide('slow');
                } else {
                    $('#config-btn-0').addClass('disabled');
                    $('#table-prices-predict').show('slow');
                }
            }).fail(function(jqXHR, textStatus, errorThrown){
                $("#loading-event").remove();
                console.log(jqXHR);
                $('#predict-freeshipping-failed-body').html(jqXHR.error);
                $("#predict-freeshipping-failed").modal("show");
            });

        });
    });
</script>